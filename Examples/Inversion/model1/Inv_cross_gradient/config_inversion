#configuration of inversion parameters. 

#Comments start with a character "#", which will not be read by the program

# How the sensitivity matrix is store, and how the conjugate gradient method is implemented
# 0: store a full sensitivity matrix, and use the lscg implementation of Eigen 3 library (lscg: least square conjugate gradient method) 
# 1: store a full sensitivity matrix, and use my own implementation of the lscg method
# 2: use the wavelet transform to compress the sensitivity matrix, and use my own implementation of the lscg method
1
# If the above option is 2 (using wavelet transform), the following relative threshold should be defined
# A larger threshold results in larger compression ratio, and larger approximation error as well
0.0005

#Weights of different regularization terms. The last term is the weight of the cross-gradient term, which makes sense only when the cross-gradient constraint is used
#a_s a_z a_x a_y a_crg
1e-5 1e-1 1e0 1e0 2e-1

#Lp norm for the regularization terms: p_s, p_x, p_y, p_z, p_t, epsilon2
#--"p": means Lp norm will be used
#--"epsilon2" :a small value is used to avoid singularity
#For L1-norm inversion (p=1), the inversion result is more focusing with smaller epsilon2, while larger value of epsilon2 produce smoother inversion results.
#The first 5 parameters specify the norms of different regularization terms: |m|, |Wz*m|, |Wx*m|, |Wy*m| and cross-gradient term
#For example, 2 1 1 1 2 1e-9 means L2 norm is used for ||m2||, L1 norm is used for ||Wx*m||, ||Wy*m||, ||Wz*m|| and 1e-9 is used to avoid sigularity
2 2 2 2 2 0

#Depth weighting exponent.
2

#Maximal regularization parameter (lambda) used, number of lambda used for trial
1e4 30 0.7

#Target misfit
1

#Stagation factor. Gauss-Newton method stagnates when the relative difference in the
#misfits of 2 consecutive iterations is smaller than this factor
0.02

#Tolerance value and maximum number of iterations for LSCG solver (least-square conjugate gradient) 
1e-6 200

#Maximal number of iterations for gauss-newton
8

#upper limit and lower limit of the inverted parameter
-1000 1000

#Maximal times of refinement. If it's 0, the mesh will not be refined.
8

#Limits on the minimum size of a grid cell in the adaptive inversion. This parameter is valid only when the last parameter is greater than 0
#x(m) y(m) z(m)
25 25 25

#invertion mesh is refine every X times. 
1

#Proportion of elements that are marked for refinement
0.2

# Do you want to save the model at each iteration of the Gauss-Newton loop? 0: No. 1: Yes
0

#whether to use cross-gradient constraint. 0 no, 1 yes
1

#Reference model used for cross gradient constraint.. Users must obtain a reference density model in advance.
#---(1) The first parameter is the filename of a gridded reference model used for cross gradient constraint. The file must have four columns. The first 3 columns 
#       are coordinates and the last column is the value of a certain physical property.
#---(2) The second parameter should be combination of characters 'x', 'y' and  'z', specifying how the coordinates are ordered in the file.
#       For example "yxz" means: y(column 1) x(column 2) z(column 3) value(column 4)
#---(3) The next 3 parameters: n1 n2 n3 are the number of grid nodes along each dimension, in a order corresponding to the previous parameter (such as "yxz").
#---(4) The final parameter is the index order which determins which axis index changes faster and which one changes slower. 
#       It is also a combination of "xyz". For example, "zxy" means the z index changes fastest, while x index changes slower and z index changes the slowest
# This model is given in a file named "constraint_as_input_format.xyz" in folder "../../../Forward_modelling/model1/model/"
# It is composed of 4 columns. First column: x, second column: y, third column: z, fourth column: value
# It has 40 points along x axis, 40 points along y axis and 20 points along z axis.
# In this file, the z coordinate changes the fastest, and the y coordinate changes slower than z. The x coordinate changes the slowest.
../../../Forward_modelling/model1/model/constraint_as_input_format.xyz xyz 40 40 20 zyx

#whether to use petrophysical constraint. 0 no, 1 yes
0

#reference density model converted from other parameter (e.g. seismic). Users must 
#convert models of other properties into density model in advance
none xyz 0 0 0 0

#output file of inversion model
gz_result_with_crg






